set hive.enforce.bucketing=true;
set hive.enforce.sorting=true;

create database if not exists ${DB};
use ${DB};

drop table if exists item;

create table item
(
    i_item_sk                 int,
    i_item_id                 string,
    i_rec_start_date          string,
    i_rec_end_date            string,
    i_item_desc               string,
    i_current_price           float,
    i_wholesale_cost          float,
    i_brand_id                int,
    i_brand                   string,
    i_class_id                int,
    i_class                   string,
    i_category_id             int,
    i_category                string,
    i_manufact_id             int,
    i_manufact                string,
    i_size                    string,
    i_formulation             string,
    i_color                   string,
    i_units                   string,
    i_container               string,
    i_manager_id              int,
    i_product_name            string
)
clustered by (i_item_sk) sorted by (i_item_sk) into ${BUCKETS} buckets
row format serde '${SERDE}'
stored as ${FILE};

insert overwrite table item
select * from ${SOURCE}.item;
